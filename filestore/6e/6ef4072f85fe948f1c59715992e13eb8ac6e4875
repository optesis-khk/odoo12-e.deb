import React, { Component } from 'react'
import { navbar, nav, navitem, menuitem, Dropdown, Col,Row, Button, NavDropdown,MenuItem ,Nav, NavItem} from 'react-bootstrap';
import { Router, Route, Link, IndexRoute, hashHistory, browserHistory, DefaultRoute, IndexLink } from 'react-router'
import NewsLetter from './newsletter.jsx'
import {SEARCH_CONTENT} from './searchContent'
import {Parser} from 'html-to-react'
import {HOMEPAGE_URL} from '../config.js'
import ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2 } from 'react-html-parser'


class SearchResult extends Component {
    constructor(props){
        super(props);
        this.state={
            keyword:"",
        }
     this.parseContent=this.parseContent.bind(this);
    }

   parseContent(data){
    var item =[];
    data.map((obj)=>{
        var tmp_data=obj.content.replace(new RegExp(this.state.keyword,'gi'),`<b style="color:#f4b705">${this.state.keyword}</b>`);
        return item.push(`<div><a href=${obj.url}>${HOMEPAGE_URL}${obj.url}</a><p>${tmp_data}</p></div>`)
    })
    return item
   }

    componentDidMount(){
            this.setState({keyword:decodeURI(window.location.search.split('=')[1])})
    }
  render() {
    var parser =new Parser();
    const data = SEARCH_CONTENT.filter(obj=>obj.content.indexOf(this.state.keyword)!==-1);
    return (
    <div> 
    <section className="page-title-section2 bg-img cover-background" data-overlay-dark="7" style={{backgroundImage:'url("/assets/img/bg/PTN_Image_04.jpeg")'}}>
                <div className="container">

                    <div className="row">
                        <div className="col-md-12">
                            <h1>Resultats de la recherche</h1>
                        </div>
                        <div className="col-md-12">

                        </div>
                    </div>

                </div>
            </section>
            <div className="container">

                <div className="row">
            <div className="text-result">
                { data.length!==0?
                    parser.parse(this.parseContent(data))
                    :<h1>Aucun résultat trouvé</h1>
                }
            </div>
        </div>
        </div>
        </div>
       
        

    )
  }
}
export default SearchResult;
